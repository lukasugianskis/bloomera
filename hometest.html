<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Bloomera · focus perfumerie</title>
  <link rel="icon" type="image/x-icon" href="/trybloomera.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  <style>
    /* ----- reset & variables (responsive) ----- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg: #F6F1EB;
      --glow: #EFE2D3;
      --pill: #8b532f;
      --pill-text: #f7f1ea;
      --ring-outer: #EAE1D5;
      --ring-inner: #F1EADE;
      --text: #5f4632;
      --soft-brown: #9A7C66;
      --accent: #C08055;
      --exit-duration: 0.65s;
      --exit-easing: cubic-bezier(0.4, 0.0, 0.2, 1);
      --exit-distance: -30px;
      --card-w: min(360px, 88vw);
      --card-h: min(500px, 70vh);
      --nav-bottom: clamp(12px, 4vh, 24px);
      --space-unit: clamp(12px, 2vw, 24px);
    }
    html, body { width: 100%; height: 100%; }
    body {
      background: var(--bg);
      font-family: 'Manrope', system-ui, -apple-system, sans-serif;
      color: var(--text);
      overflow: hidden;
      position: relative;
      line-height: 1.4;
      -webkit-font-smoothing: antialiased;
    }
    /* blurred bg circles – keep as is, just scaled */
    .blur-circle {
      position: absolute;
      width: clamp(320px, 70vw, 600px);
      height: clamp(320px, 70vw, 600px);
      border-radius: 50%;
      background: var(--glow);
      filter: blur(28px);
      opacity: 0.85;
      z-index: 0;
    }
    .blur-circle.top-right { top: -15%; right: -15%; }
    .blur-circle.bottom-left { bottom: -15%; left: -15%; }
    .page {
      position: relative;
      height: 100%;
      padding: var(--space-unit) clamp(16px, 5vw, 40px);
      display: flex;
      flex-direction: column;
      z-index: 2;
    }
    /* ----- top row & title (refined) ----- */
    .top-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      position: relative;
      z-index: 5;
    }
    .top-title {
      position: absolute;
      left: 50%;
      top: 20px;
      transform: translateX(-50%);
      font-weight: 600;
      font-size: clamp(13px, 3.5vw, 16px);
      color: var(--text);
      letter-spacing: 0.2px;
      white-space: nowrap;
      background: rgba(246,241,235,0.5);
      backdrop-filter: blur(4px);
      padding: 0.2rem 1rem;
      border-radius: 40px;
      border: 1px solid rgba(139,83,47,0.1);
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
      z-index: 2;
    }
    .top-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 60px;
      text-decoration: none;
      background: var(--pill);
      color: var(--pill-text);
      font-weight: 500;
      font-size: clamp(11px, 3vw, 13px);
      padding: 0.7rem 1.4rem;
      letter-spacing: 0.2px;
      border: none;
      box-shadow: 0 4px 10px rgba(90,64,44,0.15);
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
      white-space: nowrap;
    }
    .top-btn.left {
      position: relative;
      background: var(--pill);
    }
    .top-btn.left::before {
      content: '';
      position: absolute;
      inset: -4px;
      border-radius: 60px;
      background: var(--ring-outer);
      z-index: -2;
    }
    .top-btn.left::after {
      content: '';
      position: absolute;
      inset: -3px;
      border-radius: 60px;
      background: var(--ring-inner);
      z-index: -1;
    }
    .top-btn.right {
      background: #A5714B; /* slightly warmer */
      border-radius: 30px;
    }
    .top-btn i { font-size: 1.2em; }
    /* ----- flip card (centered, no overflow) ----- */
    .flip-card {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -44%);
      width: var(--card-w);
      height: var(--card-h);
      perspective: 1400px;
      z-index: 10;
      opacity: 0;
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
      cursor: default;
      user-select: none;
    }
    .flip-card.loaded {
      transform: translate(-50%, -50%);
      opacity: 1;
      transition: transform 0.5s ease, opacity 0.5s ease;
    }
    .flip-card.raised { transform: translate(-50%, -56%); }
    .flip-card.lowered { transform: translate(-50%, -50%); }
    .flip-card.can-flip { cursor: grab; }
    .flip-card.dragging { cursor: grabbing; }
    .flip-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.7s ease;
      transform-style: preserve-3d;
    }
    .flip-inner.is-flipped { transform: rotateY(180deg); }
    .center-frame {
      position: absolute;
      inset: 0;
      background: rgba(246,241,232,0.92);
      backdrop-filter: blur(4px);
      border-radius: 32px;
      box-shadow: 0 18px 36px -10px rgba(80,60,40,0.2), 0 0 0 1px rgba(139,83,47,0.08);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 12px 16px;
      backface-visibility: hidden;
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
      overflow-y: auto;  /* just in case content overflows */
    }
    .center-frame.back {
      transform: rotateY(180deg);
      justify-content: flex-start;
    }
    /* hide scrollbar but keep functionality */
    .center-frame::-webkit-scrollbar { width: 4px; }
    .center-frame::-webkit-scrollbar-thumb { background: #DBC9BA; border-radius: 8px; }
    .center-frame h1 {
      font-size: clamp(22px, 6vw, 28px);
      font-weight: 600;
      margin: 8px 0 4px;
      color: var(--text);
      line-height: 1.2;
    }
    .center-frame h2 {
      font-size: clamp(12px, 3.5vw, 14px);
      font-weight: 500;
      color: #C08055;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
    }
    .center-divider {
      width: 80%;
      height: 2px;
      margin: 14px 0 6px;
      background: repeating-linear-gradient(90deg, #C9AF9A 0px, #C9AF9A 6px, transparent 6px, transparent 12px);
    }
    .option-list, .notes-list {
      width: 90%;
      max-width: 280px;
      margin: 12px 0 8px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .option-btn, .note-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      background: #F2EBDD;
      border-radius: 24px;
      color: #5A3F2E;
      font-weight: 600;
      border: 1px solid #E5D6C6;
      box-shadow: 0 4px 6px rgba(0,0,0,0.02);
      transition: transform 0.18s ease, box-shadow 0.18s ease; /* keep only original transitions */
      text-decoration: none;
      opacity: 0;
      transform: translateX(-8px);
    }
    .loaded .option-btn, .loaded .note-item {
      animation: slideIn 0.4s ease forwards;
    }
    @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
    .option-btn:nth-child(1) { animation-delay: 0.05s; }
    .option-btn:nth-child(2) { animation-delay: 0.12s; }
    .option-btn:nth-child(3) { animation-delay: 0.19s; }
    .note-item:nth-child(1) { animation-delay: 0.05s; }
    .note-item:nth-child(2) { animation-delay: 0.12s; }
    .note-item:nth-child(3) { animation-delay: 0.19s; }
    .note-item:nth-child(4) { animation-delay: 0.26s; }
    .option-btn:hover { background: #EFE4D6; }  /* keep original minimal hover */
    .option-btn.selected {
      background: #E8D9C8;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      transform: translateY(3px);
    }
    .option-btn .check { color: var(--pill); opacity: 0; }
    .option-btn.selected .check { opacity: 1; }
    .option-btn strong, .note-item strong { font-size: clamp(14px, 4vw, 16px); }
    .option-btn span, .note-item small {
      font-size: clamp(10px, 2.8vw, 12px);
      color: #8F725B;
      font-weight: 600;
      display: block;
      margin-top: 2px;
    }
    /* note controls */
    .note-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .note-btn {
      width: 28px;
      height: 28px;
      border-radius: 30px;
      border: 1px solid #D4BFAD;
      background: #F7EFE4;
      color: #7B5F49;
      font-weight: 700;
      font-size: 1.2rem;
      display: grid;
      place-items: center;
      cursor: pointer;
      box-shadow: 0 2px 0 #D4BFAD;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }
    .note-btn:active { transform: translateY(2px); box-shadow: none; }
    .note-count { min-width: 20px; text-align: center; font-weight: 700; }
    .circle-row {
      display: flex;
      gap: 5px;
      margin: 16px 0 8px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .circle-row span {
      width: 5px;
      height: 5px;
      background: #B59882;
      border-radius: 50%;
    }
    .flip-hint {
      position: absolute;
      top: 50%;
      right: -140px;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: clamp(11px, 3vw, 13px);
      color: #8F725B;
      background: rgba(255,255,240,0.5);
      backdrop-filter: blur(4px);
      padding: 0.5rem 1rem;
      border-radius: 40px;
      border: 1px solid #E1CFBF;
      white-space: nowrap;
      opacity: 0;
      transition: opacity 0.2s;
      pointer-events: none;
    }
    .flip-hint.left { right: auto; left: -140px; }
    .flip-hint.ready { opacity: 1; }
    .flip-hint i { color: var(--pill); font-size: 14px; }
    /* on small screens, hide flip hint completely (makes more space) */
    @media (max-width: 680px) {
      .flip-hint { display: none; }
    }
    /* study track */
    .study-track {
      position: fixed;
      left: 50%;
      bottom: calc(var(--nav-bottom) + 70px);
      transform: translateX(-50%);
      background: #EDE3D8;
      padding: 0.5rem 1.4rem;
      border-radius: 60px;
      font-weight: 600;
      font-size: clamp(11px, 3vw, 13px);
      color: #5F4432;
      border: 1px solid #DDCBB9;
      box-shadow: 0 6px 14px rgba(0,0,0,0.05);
      opacity: 0;
      transition: opacity 0.25s, transform var(--exit-duration) var(--exit-easing);
      white-space: nowrap;
      z-index: 15;
    }
    .study-track.show { opacity: 1; }
    /* start button */
    .start-btn {
      position: fixed;
      left: 50%;
      top: calc(50% + (var(--card-h) / 2) + 20px);
      transform: translateX(-50%) translateY(10px);
      background: var(--pill);
      color: var(--pill-text);
      padding: 0.9rem 2.2rem;
      border-radius: 60px;
      font-weight: 700;
      font-size: clamp(14px, 4vw, 16px);
      text-decoration: none;
      box-shadow: 0 12px 24px -8px rgba(100,60,30,0.3);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s, transform var(--exit-duration) var(--exit-easing);
      white-space: nowrap;
      z-index: 15;
    }
    .start-btn.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%) translateY(0);
    }
    /* ----- blank frame / ticket (redesigned) ----- */
    .blank-frame {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -44%) scale(0.96);
      width: var(--card-w);
      height: var(--card-h);
      background: #F5EEE5;
      border-radius: 36px 36px 24px 24px;
      box-shadow: 0 30px 50px -20px rgba(60,40,20,0.4);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.5s var(--exit-easing), opacity 0.5s var(--exit-easing);
      z-index: 25;
      overflow: hidden;
      border: 1px solid rgba(200,170,140,0.4);
      /* perforated style */
      background-image: radial-gradient(circle at 20px 30px, #DCC9B8 2px, transparent 2px), 
        radial-gradient(circle at 80px 70px, #DCC9B8 2px, transparent 2px); /* subtle texture */
      background-size: 60px 60px;
    }
    .blank-frame::before {
      content: '';
      position: absolute;
      top: 24px;
      left: 0;
      right: 0;
      height: 4px;
      background: repeating-linear-gradient(90deg, #B3937A 0px, #B3937A 8px, transparent 8px, transparent 16px);
      opacity: 0.4;
    }
    .blank-frame::after {
      content: '';
      position: absolute;
      bottom: 20px;
      left: 10%;
      width: 80%;
      height: 2px;
      background: repeating-linear-gradient(90deg, #B3937A 0px, #B3937A 6px, transparent 6px, transparent 12px);
    }
    .blank-frame.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
      pointer-events: auto;
    }
    .blank-frame.dismissed {
      opacity: 0;
      transform: translate(-50%, -54%) scale(0.98);
      pointer-events: none;
    }
    .ticket {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      padding: 28px 16px 18px;
      color: #4F3A2A;
      position: relative;
      z-index: 2;
      background: rgba(250,244,236,0.7);
      backdrop-filter: blur(2px);
    }
    .ticket-top, .ticket-bottom { width: 100%; text-align: center; }
    .ticket h3 {
      font-size: clamp(22px, 6vw, 28px);
      font-weight: 700;
      color: #6D4C33;
      letter-spacing: -0.2px;
      margin: 0 0 4px;
    }
    .ticket p {
      color: #9F846D;
      font-weight: 500;
      font-size: clamp(11px, 3vw, 13px);
      text-transform: uppercase;
    }
    .dot-line {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px;
      margin: 16px 0 12px;
    }
    .dot-line span {
      width: 5px;
      height: 5px;
      background: #B99E89;
      border-radius: 50%;
    }
    .ticket .rows {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px 12px;
      width: 90%;
      margin: 8px auto;
      font-weight: 600;
      font-size: clamp(13px, 4vw, 16px);
      color: #4F3A2A;
      background: #EADDCf;
      padding: 16px 18px;
      border-radius: 24px;
      border: 1px dashed #C5AB95;
    }
    .ticket .rows > div:nth-child(odd) { text-align: left; color: #82644D; }
    .ticket .rows > div:nth-child(even) { text-align: right; font-weight: 700; }
    .tear-line {
      width: 90%;
      margin: 8px auto;
      stroke: #AF8D74;
      stroke-width: 2;
      stroke-dasharray: 5 4;
    }
    .tear {
      color: #A48269;
      font-weight: 600;
      font-size: 12px;
      letter-spacing: 1px;
      margin: 10px 0 6px;
      text-transform: uppercase;
    }
    .barcode {
      max-width: 70%;
      height: auto;
      margin: 10px auto;
      background: #2C221C;
      padding: 6px 0;
      border-radius: 8px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }
    .thanks {
      font-size: 14px;
      font-weight: 700;
      color: #886D58;
      margin-top: 8px;
    }
    /* ----- blend screen (timer) ----- */
    .blend-screen {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      background: rgba(246,241,235,0.75);
      backdrop-filter: blur(8px);
      opacity: 0;
      pointer-events: none;
      transform: scale(0.98);
      transition: opacity 0.4s ease, transform 0.4s ease;
      z-index: 30;
    }
    .blend-screen.show { opacity: 1; pointer-events: auto; transform: scale(1); }
    .blend-title {
      font-size: clamp(48px, 15vw, 80px);
      font-weight: 700;
      color: #6A4E39;
      line-height: 1;
      text-shadow: 0 4px 12px rgba(140,90,50,0.15);
    }
    .blend-subtitle {
      font-size: clamp(14px, 4vw, 18px);
      color: #A5714B;
      font-weight: 600;
    }
    .blend-progress {
      width: min(300px, 70vw);
      height: 8px;
      background: #E2D3C4;
      border-radius: 20px;
      overflow: hidden;
      margin: 10px 0;
    }
    .blend-progress span {
      display: block;
      height: 100%;
      background: #7C604A;
      width: 0%;
      transition: width 0.3s;
    }
    .blend-btn {
      background: #FFF5EA;
      border: 1px solid #DABEA8;
      padding: 14px 32px;
      border-radius: 60px;
      font-size: clamp(14px, 4vw, 16px);
      font-weight: 600;
      color: #6A4E39;
      box-shadow: 0 8px 20px rgba(80,50,30,0.1);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .blend-stop {
      margin-top: 12px;
      font-weight: 600;
      color: #A7866F;
      text-decoration: underline dotted;
      cursor: pointer;
      font-size: clamp(12px, 3.5vw, 14px);
    }
    /* ----- bottom nav (refined) ----- */
    .bottom-nav {
      position: fixed;
      left: 50%;
      bottom: var(--nav-bottom);
      transform: translateX(-50%) scale(1.05);
      transform-origin: center;
      z-index: 20;
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
    }
    .nav-pill {
      display: inline-flex;
      background: #F3ECE3;
      padding: 4px;
      border-radius: 60px;
      border: 1px solid #DBCBB9;
      box-shadow: 0 10px 24px -8px rgba(80,55,35,0.2);
      position: relative;
    }
    .nav-highlight {
      position: absolute;
      top: 4px;
      left: 4px;
      height: calc(100% - 8px);
      border-radius: 60px;
      background: #A5714B;
      box-shadow: 0 2px 10px rgba(140,80,40,0.3);
      transition: transform 0.3s cubic-bezier(0.2, 0.9, 0.3, 1), width 0.3s ease;
      pointer-events: none;
    }
    .nav-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 0.8rem 1.4rem;
      border-radius: 60px;
      font-size: clamp(11px, 3vw, 13px);
      font-weight: 600;
      color: #876D58;
      text-decoration: none;
      transition: color 0.2s;
      position: relative;
      z-index: 2;
      white-space: nowrap;
    }
    .nav-item.is-highlighted { color: #FFF8F0; }
    .nav-item i { font-size: 1.2em; }
    /* ----- notify overlay (unchanged but compact) ----- */
    .notify-overlay {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: rgba(0,0,0,0.1); backdrop-filter: blur(3px);
      opacity: 0; pointer-events: none; transition: opacity 0.25s; z-index: 40;
    }
    .notify-overlay.show { opacity: 1; pointer-events: auto; }
    .notify-dialog {
      background: #F6F1E8; border-radius: 28px; border: 1px solid #E2CFBD;
      box-shadow: 0 30px 50px -20px #3F2E1E; padding: 1.8rem 1.5rem;
      max-width: 340px; width: 85%; color: var(--text);
    }
    .notify-close { position: absolute; top: 14px; right: 18px; cursor: pointer; font-size: 1.6rem; }
    .notify-title { font-weight: 700; font-size: 1.4rem; margin-bottom: 8px; }
    .notify-text { color: #8D725C; font-weight: 600; font-size: 0.9rem; }
    .notify-form { display: flex; gap: 8px; margin: 16px 0 8px; flex-wrap: wrap; }
    .notify-input { flex: 1; min-width: 160px; padding: 12px; border-radius: 30px; border: 1px solid #D9C3B0; background: #FDF9F2; }
    .notify-submit { background: var(--pill); color: white; border: none; border-radius: 30px; padding: 12px 18px; font-weight: 700; cursor: pointer; }
    .notify-note { font-size: 0.8rem; color: #AD8F7A; }
    /* ----- exit animation (keep original) ----- */
    .app-exit .flip-card,
    .app-exit .bottom-nav,
    .app-exit .top-title,
    .app-exit .study-track,
    .app-exit .start-btn,
    .app-exit .center-frame {
      transform: translateY(var(--exit-distance)) translateX(-50%) scale(var(--scale,1));
      opacity: 0;
      transition: transform var(--exit-duration) var(--exit-easing), opacity var(--exit-duration) var(--exit-easing);
    }
    .app-exit .flip-card { transform: translate(-50%, -50%) translateY(var(--exit-distance)); }
    .app-exit .bottom-nav { transform: translateX(-50%) translateY(var(--exit-distance)) scale(1.05); }
    .app-exit .start-btn { transform: translateX(-50%) translateY(var(--exit-distance)); }
    .app-exit .center-frame.back { transform: rotateY(180deg) translateY(var(--exit-distance)); }
    /* small screen fine-tuning */
    @media (max-width: 480px) {
      .top-title { top: 14px; padding: 0.2rem 0.8rem; }
      .top-btn { padding: 0.6rem 1rem; }
      .center-frame { padding: 16px 8px; }
      .option-btn, .note-item { padding: 10px 14px; }
      .circle-row { gap: 4px; }
      .circle-row span { width: 4px; height: 4px; }
      .nav-item { padding: 0.6rem 1rem; }
      .barcode { max-width: 85%; }
    }
    @media (max-height: 680px) {
      :root { --card-h: 64vh; }
      .center-frame h1 { margin-top: 0; }
      .option-list, .notes-list { gap: 8px; margin: 6px 0; }
    }
  </style>
</head>
<body>
  <!-- blurred bg circles -->
  <div class="blur-circle top-right" aria-hidden="true"></div>
  <div class="blur-circle bottom-left" aria-hidden="true"></div>
  <div class="page">
    <div class="top-title">bloomera · focus perfumerie</div>
    <div class="top-row">
      <a class="top-btn left" href="#"><i class="fa-solid fa-seedling"></i>Parfumerie</a>
      <a class="top-btn right" href="#"><i class="fa-solid fa-arrow-right-to-bracket"></i>Sign In</a>
    </div>
    <!-- flip card container (exact same structure) -->
    <div class="flip-card" id="flipContainer">
      <div class="flip-inner" id="flipCard">
        <!-- front -->
        <div class="center-frame front">
          <h1>1. Choose Base</h1>
          <h2>what should it smell like</h2>
          <div class="center-divider"></div>
          <div class="option-list" id="optionList">
            <a class="option-btn" href="#" data-choice="Vanilla" data-min="10">
              <div><strong>Vanilla</strong><span>10 min focus</span></div>
              <i class="fa-solid fa-check check"></i>
            </a>
            <a class="option-btn" href="#" data-choice="Rose" data-min="25">
              <div><strong>Rose</strong><span>25 min focus</span></div>
              <i class="fa-solid fa-check check"></i>
            </a>
            <a class="option-btn" href="#" data-choice="Musk" data-min="50">
              <div><strong>Musk</strong><span>50 min focus</span></div>
              <i class="fa-solid fa-check check"></i>
            </a>
          </div>
          <div class="center-divider"></div>
          <div class="circle-row">
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span>
          </div>
          <div class="flip-hint" id="flipHintFront"><i class="fa-solid fa-angles-right"></i>Select an option to flip</div>
        </div>
        <!-- back -->
        <div class="center-frame back">
          <h1>2. Choose Notes</h1>
          <h2>optional ofc</h2>
          <div class="center-divider"></div>
          <div class="notes-list">
            <div class="note-item" data-min="5">
              <div><strong>Citrus</strong><small>+5 min focus</small></div>
              <div class="note-controls">
                <button class="note-btn" type="button" data-action="minus">−</button>
                <span class="note-count">0</span>
                <button class="note-btn" type="button" data-action="plus">+</button>
              </div>
            </div>
            <div class="note-item" data-min="7">
              <div><strong>Jasmine</strong><small>+7 min focus</small></div>
              <div class="note-controls">
                <button class="note-btn" type="button" data-action="minus">−</button>
                <span class="note-count">0</span>
                <button class="note-btn" type="button" data-action="plus">+</button>
              </div>
            </div>
            <div class="note-item" data-min="10">
              <div><strong>Amber</strong><small>+10 min focus</small></div>
              <div class="note-controls">
                <button class="note-btn" type="button" data-action="minus">−</button>
                <span class="note-count">0</span>
                <button class="note-btn" type="button" data-action="plus">+</button>
              </div>
            </div>
            <div class="note-item" data-min="12">
              <div><strong>Lavendar</strong><small>+12 min focus</small></div>
              <div class="note-controls">
                <button class="note-btn" type="button" data-action="minus">−</button>
                <span class="note-count">0</span>
                <button class="note-btn" type="button" data-action="plus">+</button>
              </div>
            </div>
          </div>
          <div class="center-divider"></div>
          <div class="circle-row">
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span>
          </div>
          <div class="flip-hint left" id="flipHintBack"><i class="fa-solid fa-angles-left"></i>Drag left to go back</div>
        </div>
      </div>
    </div>
    <!-- study time & start button -->
    <div class="study-track"><span>study time:‎ </span><span id="studyTimeValue">0 min</span></div>
    <a class="start-btn" id="startBtn" href="#">Start Blending</a>
    <!-- improved ticket frame -->
    <div class="blank-frame" id="blankFrame" aria-hidden="true">
      <div class="ticket">
        <div class="ticket-top">
          <h3>Order Slip</h3>
          <p>and how much u spent ;)</p>
          <div class="dot-line"><span></span><span></span><span></span><span></span><span></span><span></span></div>
          <div class="rows">
            <div>Item:</div><div id="receiptItem">Sprout</div>
            <div>Focus:</div><div id="receiptFocus">10 min</div>
            <div>Total:</div><div id="receiptTotal">$4</div>
          </div>
          <div class="dot-line"><span></span><span></span><span></span><span></span><span></span><span></span></div>
        </div>
        <svg class="tear-line" viewBox="0 0 100 2" preserveAspectRatio="none"><line x1="0" y1="1" x2="100" y2="1" stroke="#AF8D74" stroke-width="2" stroke-dasharray="5 4" /></svg>
        <div class="ticket-bottom">
          <div class="tear">tap to close</div>
          <div class="dot-line"><span></span><span></span><span></span><span></span><span></span><span></span></div>
          <!-- barcode placeholder (original used barcode2.png, keep but fallback) -->
          <img class="barcode" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='40' viewBox='0 0 200 40'%3E%3Crect width='8' height='40' fill='%23332'/%3E%3Crect x='12' width='6' height='40' fill='%23332'/%3E%3Crect x='22' width='10' height='40' fill='%23332'/%3E%3Crect x='36' width='4' height='40' fill='%23332'/%3E%3Crect x='44' width='12' height='40' fill='%23332'/%3E%3Crect x='60' width='6' height='40' fill='%23332'/%3E%3Crect x='70' width='8' height='40' fill='%23332'/%3E%3Crect x='82' width='14' height='40' fill='%23332'/%3E%3Crect x='100' width='6' height='40' fill='%23332'/%3E%3Crect x='110' width='10' height='40' fill='%23332'/%3E%3Crect x='124' width='4' height='40' fill='%23332'/%3E%3Crect x='132' width='8' height='40' fill='%23332'/%3E%3Crect x='144' width='12' height='40' fill='%23332'/%3E%3Crect x='160' width='6' height='40' fill='%23332'/%3E%3Crect x='170' width='8' height='40' fill='%23332'/%3E%3Crect x='182' width='6' height='40' fill='%23332'/%3E%3C/svg%3E" alt="barcode">
          <div class="dot-line"><span></span><span></span><span></span><span></span><span></span><span></span></div>
          <div class="thanks">THANK YOU &lt;3</div>
        </div>
      </div>
    </div>
    <!-- blend screen -->
    <div class="blend-screen" id="blendScreen">
      <div class="blend-title" id="blendTimer">25:00</div>
      <div class="blend-subtitle">blending in progress</div>
      <div class="blend-progress"><span></span></div>
      <button class="blend-btn"><span class="blend-pause">‖</span><span class="blend-label">pause blending</span></button>
      <div class="blend-stop">stop blending</div>
    </div>
    <!-- notify overlay -->
    <div class="notify-overlay" id="notifyOverlay">
      <div class="notify-dialog">
        <div class="notify-close" id="notifyClose">×</div>
        <div class="notify-title">Coming soon</div>
        <div class="notify-text" id="notifyText">This section isn't ready yet. Want an email when it drops?</div>
        <form class="notify-form" id="notifyForm">
          <input class="notify-input" id="notifyEmail" type="email" placeholder="you@example.com" required>
          <button class="notify-submit">Notify me</button>
        </form>
        <div class="notify-note" id="notifyNote">We only email about launches, never spam.</div>
      </div>
    </div>
    <!-- bottom nav -->
    <div class="bottom-nav">
      <div class="nav-pill">
        <div class="nav-highlight"></div>
        <a class="nav-item active" href="#" data-page="perfumerie" data-highlight-width="116" data-highlight-offset="0"><i class="fa-solid fa-seedling"></i>Perfumerie</a>
        <a class="nav-item" href="#" data-page="collection" data-highlight-width="106" data-highlight-offset="-12"><i class="fa-solid fa-layer-group"></i>Collection</a>
        <a class="nav-item" href="#" data-page="profile" data-highlight-width="90" data-highlight-offset="-22"><i class="fa-solid fa-user"></i>Profile</a>
      </div>
    </div>
  </div>
  <!-- (keep existing script exactly – unchanged) -->
  <script>
    // (the original script is kept verbatim to preserve all interactions)
    const flipCard = document.getElementById("flipCard");
    const flipContainer = document.querySelector(".flip-card");
    const optionLists = document.querySelectorAll(".option-list");
    const flipHintFront = document.getElementById("flipHintFront");
    const flipHintBack = document.getElementById("flipHintBack");
    const startBtn = document.getElementById("startBtn");
    const blankFrame = document.getElementById("blankFrame");
    const blendScreen = document.getElementById("blendScreen");
    const receiptItem = document.getElementById("receiptItem");
    const receiptFocus = document.getElementById("receiptFocus");
    const receiptTotal = document.getElementById("receiptTotal");
    const blendTimer = document.getElementById("blendTimer");
    const blendSubtitle = document.querySelector(".blend-subtitle");
    const blendProgress = document.querySelector(".blend-progress");
    const blendProgressBar = document.querySelector(".blend-progress span");
    const blendPauseBtn = document.querySelector(".blend-btn");
    const blendStopBtn = document.querySelector(".blend-stop");
    const navPill = document.querySelector(".nav-pill");
    const navHighlight = document.querySelector(".nav-highlight");
    const navItems = document.querySelectorAll(".nav-item");
    const signInBtn = document.querySelector(".top-btn.right");
    let activeNavItem = document.querySelector(".nav-item.active");
    let navBounceTimeout = null;
    const notesList = document.querySelector(".center-frame.back .notes-list");
    const studyTimeValue = document.getElementById("studyTimeValue");
    const studyTrack = document.querySelector(".study-track");
    const notifyOverlay = document.getElementById("notifyOverlay");
    const notifyText = document.getElementById("notifyText");
    const notifyNote = document.getElementById("notifyNote");
    const notifyEmail = document.getElementById("notifyEmail");
    const notifyForm = document.getElementById("notifyForm");
    const notifyClose = document.getElementById("notifyClose");
    let canFlip = false;
    let startX = null;
    let isDragging = false;
    let backInteracted = false;
    let startUnlocked = false;
    let timerId = null;
    let timerState = { remaining: 0, total: 0, paused: false };

    const computeTotalMinutes = () => {
      const selectedBase = document.querySelector(".center-frame.front .option-btn.selected");
      const baseMin = selectedBase ? Number(selectedBase.dataset.min || 0) : 0;
      let notesMin = 0;
      document.querySelectorAll(".note-item").forEach((item) => {
        const perMin = Number(item.dataset.min || 0);
        const countEl = item.querySelector(".note-count");
        const count = Number(countEl?.textContent || 0);
        notesMin += perMin * count;
      });
      const total = baseMin + notesMin;
      if (studyTimeValue) studyTimeValue.textContent = `${total} min`;
      return { total, baseMin, notesMin };
    };
    const formatTime = (seconds) => {
      const totalSeconds = Math.max(0, Math.round(seconds));
      const m = Math.floor(totalSeconds / 60);
      const s = totalSeconds % 60;
      return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
    };
    const updateStartState = () => {
      const frontSelected = document.querySelector(".center-frame.front .option-btn.selected");
      const onBack = flipCard.classList.contains("is-flipped");
      if (frontSelected && (backInteracted || onBack)) startUnlocked = true;
      if (studyTrack) studyTrack.classList.toggle("show", Boolean(frontSelected));
      if (startUnlocked) {
        flipContainer.classList.add("raised");
        startBtn.classList.add("show");
        if (!onBack) flipContainer.classList.add("lowered");
        else flipContainer.classList.remove("lowered");
      } else {
        flipContainer.classList.remove("raised", "lowered");
        startBtn.classList.remove("show");
      }
      computeTotalMinutes();
    };
    const updateTimerUI = () => {
      const remaining = Math.max(0, timerState.remaining);
      if (blendTimer) {
        blendTimer.textContent = formatTime(remaining);
        blendTimer.classList.toggle("paused", timerState.paused);
      }
      if (blendSubtitle) blendSubtitle.classList.toggle("paused", timerState.paused);
      if (blendProgressBar && timerState.total > 0) {
        const progress = 1 - remaining / timerState.total;
        blendProgressBar.style.width = `${Math.min(100, Math.max(0, progress * 100))}%`;
      }
      if (blendProgress) blendProgress.classList.toggle("paused", timerState.paused);
    };
    const moveNavHighlight = (targetItem) => {
      if (!navHighlight || !navPill || !targetItem) return;
      const pillRect = navPill.getBoundingClientRect();
      const itemRect = targetItem.getBoundingClientRect();
      const customWidth = parseFloat(targetItem.dataset.highlightWidth);
      const highlightWidth = Number.isFinite(customWidth) && customWidth > 0 ? customWidth : itemRect.width;
      const customOffset = parseFloat(targetItem.dataset.highlightOffset);
      const extraOffset = Number.isFinite(customOffset) ? customOffset : 0;
      const baseLeft = itemRect.left - pillRect.left - 12;
      const leftOffset = baseLeft + (itemRect.width - highlightWidth) / 2 + extraOffset;
      navHighlight.style.width = `${highlightWidth}px`;
      navHighlight.style.transform = `translateX(${leftOffset}px)`;
    };
    const setNavHighlightTarget = (targetItem) => {
      if (!targetItem) return;
      navItems.forEach((el) => el.classList.remove("is-highlighted"));
      targetItem.classList.add("is-highlighted");
      moveNavHighlight(targetItem);
    };
    if (signInBtn) {
      signInBtn.addEventListener("click", (event) => {
        event.preventDefault();
        openNotifyOverlay("signin");
      });
    }
    const openNotifyOverlay = (page) => {
      if (!notifyOverlay) return;
      const label = page === "collection" ? "Collection" : page === "profile" ? "Profile" : page === "signin" ? "Sign In" : "This";
      if (notifyText) notifyText.textContent = `${label} isn't ready yet. Want an email when it drops?`;
      if (notifyNote) notifyNote.textContent = "We only email about launches, never spam.";
      if (notifyEmail) { notifyEmail.value = ""; setTimeout(() => notifyEmail.focus(), 50); }
      notifyOverlay.classList.add("show");
      notifyOverlay.setAttribute("aria-hidden", "false");
    };
    const closeNotifyOverlay = () => {
      if (!notifyOverlay) return;
      notifyOverlay.classList.remove("show");
      notifyOverlay.setAttribute("aria-hidden", "true");
    };
    const flipHintsDuringTurn = (showBack) => {
      const targetShow = showBack ? flipHintBack : flipHintFront;
      const targetHide = showBack ? flipHintFront : flipHintBack;
      [flipHintFront, flipHintBack].forEach((el) => { if (!el) return; el.classList.add("fade-out"); });
      setTimeout(() => {
        if (targetHide) targetHide.classList.remove("ready");
        if (targetShow) targetShow.classList.add("ready");
        [flipHintFront, flipHintBack].forEach((el) => { if (!el) return; el.classList.remove("fade-out"); });
      }, 520);
    };
    const startTimer = (totalMinutes) => {
      const totalSeconds = Math.max(1, Math.round(totalMinutes * 60));
      timerState = { remaining: totalSeconds, total: totalSeconds, paused: false };
      if (timerId) clearInterval(timerId);
      updateTimerUI();
      timerId = setInterval(() => {
        if (timerState.paused) return;
        timerState.remaining -= 1;
        updateTimerUI();
        if (timerState.remaining <= 0) { clearInterval(timerId); timerId = null; }
      }, 1000);
    };
    optionLists.forEach((list) => {
      list.addEventListener("click", (event) => {
        const btn = event.target.closest(".option-btn");
        if (!btn) return;
        event.preventDefault();
        list.querySelectorAll(".option-btn").forEach((item) => item.classList.remove("selected"));
        btn.classList.add("selected");
        if (!flipCard.classList.contains("is-flipped")) {
          canFlip = true;
          flipHintFront.classList.add("ready");
          flipHintFront.lastChild.textContent = "Drag right to flip";
          flipHintBack.classList.add("ready");
          flipContainer.classList.add("can-flip");
        }
        updateStartState();
      });
    });
    navItems.forEach((item) => {
      item.addEventListener("click", (event) => {
        if (event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) return;
        event.preventDefault();
        const page = item.dataset.page;
        const isHome = page === "perfumerie";
        if (!isHome) {
          if (navBounceTimeout) clearTimeout(navBounceTimeout);
          navItems.forEach((el) => el.classList.remove("bounce-active"));
          item.classList.add("bounce-active");
          setNavHighlightTarget(item);
          navBounceTimeout = setTimeout(() => {
            navItems.forEach((el) => el.classList.remove("bounce-active"));
            if (activeNavItem) setNavHighlightTarget(activeNavItem);
          }, 620);
          openNotifyOverlay(page);
          return;
        }
        navItems.forEach((el) => el.classList.remove("active", "bounce-active"));
        item.classList.add("active");
        activeNavItem = item;
        setNavHighlightTarget(item);
      });
    });
    const initialActiveNav = activeNavItem || document.querySelector(".nav-item.active");
    if (initialActiveNav) setNavHighlightTarget(initialActiveNav);
    if (notifyClose) notifyClose.addEventListener("click", closeNotifyOverlay);
    if (notifyOverlay) notifyOverlay.addEventListener("click", (event) => { if (event.target === notifyOverlay) closeNotifyOverlay(); });
    if (notifyForm) {
      notifyForm.addEventListener("submit", (event) => {
        event.preventDefault();
        if (notifyNote) notifyNote.textContent = "Thanks! We'll let you know as soon as it's live.";
        setTimeout(closeNotifyOverlay, 900);
      });
    }
    let resizeTimeout;
    window.addEventListener("resize", () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(() => {
        const highlighted = document.querySelector(".nav-item.is-highlighted") || document.querySelector(".nav-item.active");
        if (highlighted) setNavHighlightTarget(highlighted);
      }, 100);
    });
    if (notesList) {
      notesList.addEventListener("click", (event) => {
        const btn = event.target.closest(".note-btn");
        if (!btn) return;
        event.preventDefault();
        const controls = btn.closest(".note-controls");
        const countEl = controls.querySelector(".note-count");
        let count = Number(countEl.textContent) || 0;
        if (btn.dataset.action === "plus") count += 1;
        if (btn.dataset.action === "minus") count = Math.max(0, count - 1);
        countEl.textContent = count;
        backInteracted = true;
        updateStartState();
      });
    }
    flipContainer.addEventListener("pointerdown", (event) => {
      if (!canFlip) return;
      if (event.target.closest(".option-btn")) return;
      isDragging = true;
      startX = event.clientX;
      flipContainer.classList.add("dragging");
    });
    flipContainer.addEventListener("pointermove", (event) => {
      if (!isDragging || startX === null) return;
      const deltaX = event.clientX - startX;
      if (Math.abs(deltaX) < 80) return;
      if (deltaX > 0 && !flipCard.classList.contains("is-flipped")) {
        flipCard.classList.add("is-flipped");
        flipContainer.classList.add("flipping");
        setTimeout(() => flipContainer.classList.remove("flipping"), 520);
        flipHintsDuringTurn(true);
        updateStartState();
      }
      if (deltaX < 0 && flipCard.classList.contains("is-flipped")) {
        flipCard.classList.remove("is-flipped");
        flipContainer.classList.add("flipping");
        setTimeout(() => flipContainer.classList.remove("flipping"), 520);
        flipHintsDuringTurn(false);
        updateStartState();
      }
      isDragging = false; startX = null; flipContainer.classList.remove("dragging");
    });
    const endDrag = () => {
      if (!isDragging) return;
      isDragging = false; startX = null; flipContainer.classList.remove("dragging");
    };
    flipContainer.addEventListener("pointerup", endDrag);
    flipContainer.addEventListener("pointercancel", endDrag);
    startBtn.addEventListener("click", (event) => {
      event.preventDefault();
      flipHintFront.classList.remove("ready");
      flipHintBack.classList.remove("ready");
      document.body.classList.add("app-exit");
      const selectedBase = document.querySelector(".center-frame.front .option-btn.selected");
      const baseName = selectedBase?.dataset.choice || "Sprout";
      const { total, baseMin, notesMin } = computeTotalMinutes();
      const price = Math.max(3, Math.round(baseMin * 0.15 + notesMin * 0.2 + 3));
      if (receiptItem) receiptItem.textContent = baseName;
      if (receiptFocus) receiptFocus.textContent = `${total} min`;
      if (receiptTotal) receiptTotal.textContent = `$${price}`;
      startTimer(total || 25);
      setTimeout(() => {
        if (blankFrame) { blankFrame.classList.remove("dismissed"); blankFrame.classList.add("show"); }
        if (blendScreen) blendScreen.classList.remove("show");
      }, 650);
    });
    if (blendPauseBtn) {
      blendPauseBtn.addEventListener("click", () => {
        if (!timerId) return;
        timerState.paused = !timerState.paused;
        const pauseIcon = blendPauseBtn.querySelector(".blend-pause");
        const label = blendPauseBtn.querySelector(".blend-label");
        if (pauseIcon) pauseIcon.textContent = timerState.paused ? "▶" : "‖";
        if (label) label.textContent = timerState.paused ? "resume blending" : "pause blending";
        updateTimerUI();
      });
    }
    if (blendStopBtn) {
      blendStopBtn.addEventListener("click", () => {
        if (timerId) { clearInterval(timerId); timerId = null; }
        timerState = { remaining: 0, total: timerState.total, paused: false };
        const pauseIcon = blendPauseBtn?.querySelector(".blend-pause");
        const label = blendPauseBtn?.querySelector(".blend-label");
        if (pauseIcon) pauseIcon.textContent = "‖";
        if (label) label.textContent = "pause blending";
        if (blendProgressBar) blendProgressBar.style.width = "0%";
        updateTimerUI();
        if (blendTimer) blendTimer.textContent = "blend stopped";
        setTimeout(() => { window.location.reload(); }, 900);
      });
    }
    if (blankFrame) {
      blankFrame.addEventListener("click", () => {
        if (!blankFrame.classList.contains("show")) return;
        blankFrame.classList.add("dismissed");
        if (blendScreen) { setTimeout(() => { blendScreen.classList.add("show"); }, 320); }
      });
    }
    window.addEventListener("load", () => {
      flipContainer.classList.add("loaded");
      const activeItem = document.querySelector(".nav-item.active");
      if (activeItem && navHighlight) moveNavHighlight(activeItem);
    });
  </script>
</body>
</html>